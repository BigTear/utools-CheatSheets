<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<!--
generated by Pygments <https://pygments.org/>
Copyright 2006-2021 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
-->
<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
/*
generated by Pygments <https://pygments.org/>
Copyright 2006-2021 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
*/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
body .hll { background-color: #ffffcc }
body { background: #f8f8f8; }
body .c { color: #3D7B7B; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #008000; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
body .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
body .cp { color: #9C6500 } /* Comment.Preproc */
body .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
body .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
body .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #E40000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #008400 } /* Generic.Inserted */
body .go { color: #717171 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #008000 } /* Keyword.Pseudo */
body .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #B00040 } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BA2121 } /* Literal.String */
body .na { color: #687822 } /* Name.Attribute */
body .nb { color: #008000 } /* Name.Builtin */
body .nc { color: #0000FF; font-weight: bold } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #717171; font-weight: bold } /* Name.Entity */
body .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
body .nf { color: #0000FF } /* Name.Function */
body .nl { color: #767600 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #19177C } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #666666 } /* Literal.Number.Bin */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sa { color: #BA2121 } /* Literal.String.Affix */
body .sb { color: #BA2121 } /* Literal.String.Backtick */
body .sc { color: #BA2121 } /* Literal.String.Char */
body .dl { color: #BA2121 } /* Literal.String.Delimiter */
body .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BA2121 } /* Literal.String.Double */
body .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BA2121 } /* Literal.String.Heredoc */
body .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #A45A77 } /* Literal.String.Regex */
body .s1 { color: #BA2121 } /* Literal.String.Single */
body .ss { color: #19177C } /* Literal.String.Symbol */
body .bp { color: #008000 } /* Name.Builtin.Pseudo */
body .fm { color: #0000FF } /* Name.Function.Magic */
body .vc { color: #19177C } /* Name.Variable.Class */
body .vg { color: #19177C } /* Name.Variable.Global */
body .vi { color: #19177C } /* Name.Variable.Instance */
body .vm { color: #19177C } /* Name.Variable.Magic */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span></span> <span class="c1">--------------------------------------------------------------------------------</span>
 <span class="c1">-- Lua CHEATSHEET (中文速查表)  -  by weizhixiangcoder (created on 2020/06/20)</span>
 <span class="c1">-- Version: 1</span>
 <span class="c1">-- https://github.com/skywind3000/awesome-cheatsheets</span>
 <span class="c1">--------------------------------------------------------------------------------</span>
 

<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	Lua 特性：</span>
<span class="cm">		轻量级：源码2.5万行左右C代码， 方便嵌入进宿主语言(C/C++)</span>
<span class="cm">		可扩展：提供了易于使用的扩展接口和机制， 使用宿主语言提供的功能</span>
<span class="cm">		高效性：运行最快的脚本语言之一</span>
<span class="cm">		可移植：跨平台</span>
<span class="cm">	入门书籍《lua程序设计》</span>
<span class="cm">		推荐：云风翻译的《Lua 5.3参考手册》	</span>
<span class="cm">		http://cloudwu.github.io/lua53doc/manual.html</span>
<span class="cm">	源码： </span>
<span class="cm">		http://www.lua.org/ftp/</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	变量: 作为动态类型语言，变量本身没有类型， 赋值决定某一时刻变量的类型。私有静态</span>
<span class="cm">	变量带local, 公有静态变量不带local。</span>
<span class="cm">		数据类型：</span>
<span class="cm">			nil            	为空，无效值，在条件判断中表示false</span>
<span class="cm">			boolean			包含两个值：false和true</span>
<span class="cm">			number			表示双精度类型的实浮点数</span>
<span class="cm">			string			字符串由一对双引号或单引号来表示</span>
<span class="cm">			function		由 C 或 Lua 编写的函数</span>
<span class="cm">			table			Lua 中的表（table）其实是一个&quot;关联数组&quot;（associative</span>
<span class="cm">							arrays），数组的索引可以是数字、字符串或表类型</span>
<span class="cm">			thread			协程</span>
<span class="cm">			userdata		存储在变量中的C数据结构</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--nil</span>

<span class="n">signal</span> <span class="o">=</span> <span class="kc">true</span>				
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--boolean</span>

<span class="n">signal</span> <span class="o">=</span> <span class="mi">1454</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--number</span>

<span class="n">signal</span> <span class="o">=</span> <span class="s2">&quot;UnionTech&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--string			</span>

<span class="n">signal</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span> 
	<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="kr">end</span> 	
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--function</span>

<span class="n">signal</span> <span class="o">=</span> <span class="p">{}</span>								
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--table</span>

<span class="n">signal</span> <span class="o">=</span> <span class="nb">coroutine.create</span><span class="p">(</span><span class="kr">function</span><span class="p">()</span>
	<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="kr">end</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>						<span class="c1">--coroutine</span>



<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	流程控制：if...elseif...else、 while、 for</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="c1">--if...else</span>
<span class="n">ty_signal</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="kr">if</span> <span class="n">ty_signal</span> <span class="o">==</span> <span class="s2">&quot;coroutine&quot;</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;signal type is coroutine&quot;</span><span class="p">)</span>
<span class="kr">elseif</span> <span class="n">ty_signal</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span> <span class="kr">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;signal type is table&quot;</span><span class="p">)</span>
<span class="kr">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;signal type is other&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="c1">--while</span>
<span class="n">ut_companys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beijing company&quot;</span><span class="p">,</span> <span class="s2">&quot;shanghai company&quot;</span><span class="p">,</span> <span class="s2">&quot;nanjing company&quot;</span><span class="p">,</span> <span class="s2">&quot;wuxi company&quot;</span><span class="p">,</span> <span class="s2">&quot;guangzhou company&quot;</span><span class="p">,</span> <span class="s2">&quot;yunfu company&quot;</span><span class="p">,</span> <span class="s2">&quot;wuhan company&quot;</span><span class="p">,</span> <span class="s2">&quot;chengdu company&quot;</span><span class="p">,</span> <span class="s2">&quot;xian company&quot;</span><span class="p">}</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kr">while</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="o">#</span><span class="n">ut_companys</span> 
<span class="kr">do</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ut_companys[&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="s2">&quot;] is &quot;</span><span class="p">,</span> <span class="n">ut_companys</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
<span class="kr">end</span>

<span class="c1">--for</span>
<span class="kr">for</span> <span class="n">i</span><span class="o">=#</span><span class="n">ut_companys</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="kr">do</span>        <span class="c1">--以2为步长反向遍历</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;num: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;company: &quot;</span><span class="p">,</span> <span class="n">ut_companys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="kr">end</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	table： 表作为Lua唯一自带的数据结构， 使用简单方便， 兼具数组和Map作为容器的</span>
<span class="cm">	功能，通过表可以很容易组成常见的数据结构， 如栈、队列、链表、集合，用for循环</span>
<span class="cm">	很容易迭代遍历表数据。</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="c1">--table当数组用，下标从1开始</span>
<span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">ut_companys</span><span class="p">)</span> <span class="kr">do</span>
	<span class="nb">print</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;1 UnionTech company: %d		%s&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<span class="kr">end</span>

<span class="nb">table.sort</span><span class="p">(</span><span class="n">ut_companys</span><span class="p">)</span>
<span class="kr">for</span> <span class="n">i</span><span class="o">=#</span><span class="n">ut_companys</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="kr">do</span>
	<span class="nb">print</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;2 UnionTech company: %d		%s&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ut_companys</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="kr">end</span>

<span class="c1">--table当hash map用</span>
<span class="n">ut_cptypes</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">ut_cptypes</span><span class="p">[</span><span class="s2">&quot;adapter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beijing company&quot;</span><span class="p">,</span> <span class="s2">&quot;wuhan company&quot;</span><span class="p">,</span> <span class="s2">&quot;guangzhou company&quot;</span><span class="p">}</span>
<span class="n">ut_cptypes</span><span class="p">[</span><span class="s2">&quot;developer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beijing company&quot;</span><span class="p">,</span> <span class="s2">&quot;wuhan company&quot;</span><span class="p">,</span> <span class="s2">&quot;nanjing company&quot;</span><span class="p">,</span> <span class="s2">&quot;chengdu company&quot;</span><span class="p">,</span> <span class="s2">&quot;xian company&quot;</span><span class="p">,</span> <span class="s2">&quot;guangzhou company&quot;</span><span class="p">}</span>
<span class="n">ut_cptypes</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;beijing company&quot;</span><span class="p">}</span>

<span class="kr">for</span> <span class="n">ty</span><span class="p">,</span> <span class="n">cps</span> <span class="kr">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">ut_cptypes</span><span class="p">)</span> <span class="kr">do</span>
	<span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cp</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">cps</span><span class="p">)</span> <span class="kr">do</span>
		<span class="nb">print</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;3 UnionTech companys: type:%s  identifier:%s	company:%s&quot;</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">cp</span><span class="p">))</span>
	<span class="kr">end</span>
<span class="kr">end</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	函数：在Lua中函数也是第一类型值， 可赋值给变量， 也可以在函数体内定义并使用函数，或者</span>
<span class="cm">	是直接使用匿名匿名函数。</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="c1">--多重返回值</span>
<span class="n">ut_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;adapter&quot;</span><span class="p">,</span> <span class="s2">&quot;developer&quot;</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">}</span>
<span class="kr">function</span> <span class="nf">company_types</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">cptypes</span><span class="p">)</span>
	<span class="kd">local</span> <span class="n">adpt</span><span class="p">,</span> <span class="n">dvlp</span><span class="p">,</span> <span class="n">genl</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span>
	<span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ty</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">ut_types</span><span class="p">)</span> <span class="kr">do</span>
		<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_cp</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">cptypes</span><span class="p">[</span><span class="n">ty</span><span class="p">])</span> <span class="kr">do</span>
			<span class="kr">if</span> <span class="n">_cp</span> <span class="o">==</span> <span class="n">cp</span> <span class="kr">then</span>
				<span class="kr">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="kr">then</span>
					<span class="n">adpt</span> <span class="o">=</span> <span class="kc">true</span>
				<span class="kr">elseif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="kr">then</span>
					<span class="n">dvlp</span> <span class="o">=</span> <span class="kc">true</span>
				<span class="kr">elseif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span> <span class="kr">then</span>
					<span class="n">genl</span> <span class="o">=</span> <span class="kc">true</span>
				<span class="kr">end</span>
				<span class="kr">break</span>
			<span class="kr">end</span>
		<span class="kr">end</span>
	<span class="kr">end</span>
	<span class="kr">return</span> <span class="n">adpt</span><span class="p">,</span> <span class="n">dvlp</span><span class="p">,</span> <span class="n">genl</span>
<span class="kr">end</span>

<span class="n">cp</span> <span class="o">=</span> <span class="s2">&quot;wuhan company&quot;</span>
<span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">company_types</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">ut_cptypes</span><span class="p">)}</span>

<span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ty</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="kr">do</span>
	<span class="kr">if</span> <span class="n">ty</span> <span class="kr">then</span>
		<span class="nb">print</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;%s  is %s&quot;</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">ut_types</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
	<span class="kr">end</span>
<span class="kr">end</span> 

<span class="c1">--变参</span>
<span class="kr">function</span> <span class="nf">printf</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="p">...)</span>
	<span class="nb">print</span><span class="p">(</span><span class="nb">string.format</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="p">...))</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nf">add_companys</span><span class="p">(...)</span>
	<span class="kd">local</span> <span class="n">newcps</span> <span class="o">=</span> <span class="p">{...}</span>
	<span class="kd">local</span> <span class="n">num</span> <span class="o">=</span> <span class="o">#</span><span class="n">newcps</span>
	<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">cp</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">newcps</span><span class="p">)</span> <span class="kr">do</span>
		<span class="nb">table.insert</span><span class="p">(</span><span class="n">ut_companys</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
	<span class="kr">end</span>
	<span class="kr">return</span> <span class="n">ut_companys</span><span class="p">,</span> <span class="n">num</span>
<span class="kr">end</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">add_companys</span><span class="p">(</span><span class="s2">&quot;changsha company&quot;</span><span class="p">,</span> <span class="s2">&quot;zhengzhou company&quot;</span><span class="p">,</span> <span class="s2">&quot;hefei company&quot;</span><span class="p">)</span>
<span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">ut_companys</span> <span class="kr">do</span>
	<span class="c1">--print(string.format(&quot;4 UnionTech company: %d		%s&quot;, i, ut_companys[i]))</span>
	<span class="n">printf</span><span class="p">(</span><span class="s2">&quot;4 UnionTech company: %d		%s&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ut_companys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="kr">end</span>

<span class="c1">--闭包</span>
<span class="kr">function</span> <span class="nf">all_companys</span><span class="p">(</span><span class="n">cps</span><span class="p">)</span>
	<span class="kd">local</span> <span class="n">companys</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="p">{},</span> <span class="mi">0</span>
	<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">cps</span><span class="p">)</span> <span class="kr">do</span>
		<span class="nb">table.insert</span><span class="p">(</span><span class="n">companys</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
	<span class="kr">end</span>
	<span class="kr">return</span> <span class="kr">function</span><span class="p">()</span>
		<span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="kr">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="o">#</span><span class="n">companys</span> <span class="kr">then</span>
			<span class="kr">return</span> <span class="s2">&quot;&quot;</span>
		<span class="kr">else</span>
			<span class="kr">return</span> <span class="n">companys</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
		<span class="kr">end</span>
	<span class="kr">end</span>
<span class="kr">end</span>

<span class="n">get_company</span> <span class="o">=</span> <span class="n">all_companys</span><span class="p">(</span><span class="n">ut_companys</span><span class="p">)</span>
<span class="kr">while</span> <span class="kc">true</span>
<span class="kr">do</span>
	<span class="n">cp</span> <span class="o">=</span> <span class="n">get_company</span><span class="p">()</span>
	<span class="kr">if</span> <span class="n">cp</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="kr">then</span>
		<span class="kr">break</span>
	<span class="kr">else</span>	
		<span class="n">printf</span><span class="p">(</span><span class="s2">&quot;get company: %s&quot;</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
	<span class="kr">end</span>
<span class="kr">end</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	协程(coroutine)：Lua协同程序(coroutine)与线程比较类似：拥有独立的堆栈，独立的局</span>
<span class="cm">	部变量，独立的指令指针，同时又与其它协同程序共享全局变量和其它大部分东西。</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="kr">function</span> <span class="nf">foo</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo 函数输出&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="kr">return</span> <span class="nb">coroutine.yield</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="c1">-- 返回  2*a 的值</span>
<span class="kr">end</span>
 
<span class="n">co</span> <span class="o">=</span> <span class="nb">coroutine.create</span><span class="p">(</span><span class="kr">function</span> <span class="p">(</span><span class="n">a</span> <span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;第一次协同程序执行输出&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="c1">-- co-body 1 10</span>
    <span class="kd">local</span> <span class="n">r</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
     
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;第二次协同程序执行输出&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">coroutine.yield</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>  <span class="c1">-- a，b的值为第一次调用协同程序时传入</span>
     
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;第三次协同程序执行输出&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="kr">return</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;结束协同程序&quot;</span>                   <span class="c1">-- b的值为第二次调用协同程序时传入</span>
<span class="kr">end</span><span class="p">)</span>
       
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="nb">coroutine.resume</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="c1">-- true, 4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="nb">coroutine.resume</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span> <span class="c1">-- true 11 -9</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="nb">coroutine.resume</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">))</span> <span class="c1">-- true 10 end</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="nb">coroutine.resume</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">))</span> <span class="c1">-- cannot resume dead coroutine</span>
<span class="c1">--resume将主协程数据传入次协程， yield将次协程中数据传回主协程</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	元表(Metatable)：本质上来说就是存放元方法的表结构， 通过元表实现对表中数据和行为</span>
<span class="cm">	的改变。</span>
<span class="cm">	Lua 查找一个表元素时的规则，其实就是如下 3 个步骤:</span>
<span class="cm">		1.在表中查找，如果找到，返回该元素，找不到则继续</span>
<span class="cm">		2.判断该表是否有元表，如果没有元表，返回 nil，有元表则继续。</span>
<span class="cm">		3.判断元表有没有 __index 方法，如果 __index 方法为 nil，则返回 nil；如果</span>
<span class="cm">		__index 方法是一个表，则重复 1、2、3；如果 __index 方法是一个函数，则返</span>
<span class="cm">		回该函数的返回值</span>
<span class="cm">	</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="n">father</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">colourofskin</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
	<span class="n">weight</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span>
	<span class="n">work</span> <span class="o">=</span> <span class="s2">&quot;programming&quot;</span><span class="p">,</span>
	<span class="n">otherwork</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span> 
		<span class="nb">print</span> <span class="s2">&quot;do housework&quot;</span>
	<span class="kr">end</span>
<span class="p">}</span>
<span class="n">father</span><span class="p">.</span><span class="n">__index</span> <span class="o">=</span> <span class="n">father</span>

<span class="n">son</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">weight</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
	<span class="n">like</span> <span class="o">=</span> <span class="s2">&quot;basketball&quot;</span>
<span class="p">}</span>

<span class="nb">setmetatable</span><span class="p">(</span><span class="n">son</span><span class="p">,</span> <span class="n">father</span><span class="p">)</span>
<span class="n">printf</span><span class="p">(</span><span class="s2">&quot;weight:%d 	like:%s  	work:%s		colourofskin:%s &quot;</span><span class="p">,</span> <span class="n">son</span><span class="p">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">son</span><span class="p">.</span><span class="n">like</span><span class="p">,</span> <span class="n">son</span><span class="p">.</span><span class="n">work</span><span class="p">,</span> <span class="n">son</span><span class="p">.</span><span class="n">colourofskin</span><span class="p">)</span>
<span class="n">son</span><span class="p">.</span><span class="n">otherwork</span><span class="p">()</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">    面向对象：因为lua本身不是面向对象的语言， 在lua中， 通过table和function来模拟一个对象， </span>
<span class="cm">    用metatable来模拟面向对象中的继承，但是在使用的时候需要考虑lua作为脚本语言， 变量的类型随</span>
<span class="cm">    所赋值类型而改变。</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>
<span class="c1">--父类</span>
<span class="n">rect</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
    <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">function</span> <span class="nc">rect</span><span class="p">:</span><span class="nf">getArea</span><span class="p">()</span>
    <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">area</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span>
        <span class="n">self</span><span class="p">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span>
    <span class="kr">end</span>
    
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">area</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">rect</span><span class="p">:</span><span class="nf">getLength</span><span class="p">()</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">length</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">rect</span><span class="p">:</span><span class="nf">new</span><span class="p">(</span><span class="n">leng</span><span class="p">,</span> <span class="n">wid</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">leng</span>
    <span class="n">self</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">wid</span>
    <span class="kr">return</span> <span class="n">self</span>    
<span class="kr">end</span>

<span class="c1">--子类</span>
<span class="n">cuboid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">function</span> <span class="nc">cuboid</span><span class="p">:</span><span class="nf">getVolume</span><span class="p">()</span>
    <span class="kr">if</span> <span class="n">self</span><span class="p">.</span><span class="n">volume</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span>
        <span class="n">self</span><span class="p">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">self</span><span class="p">:</span><span class="n">getArea</span><span class="p">()</span>
    <span class="kr">end</span>
    <span class="kr">return</span> <span class="n">self</span><span class="p">.</span><span class="n">volume</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nc">cuboid</span><span class="p">:</span><span class="nf">new</span><span class="p">(</span><span class="n">_rect</span><span class="p">,</span> <span class="n">_height</span><span class="p">)</span>
    <span class="nb">setmetatable</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">_rect</span><span class="p">)</span>
    <span class="n">_rect</span><span class="p">.</span><span class="n">__index</span> <span class="o">=</span> <span class="n">_rect</span>
    <span class="n">self</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">_height</span>
    <span class="kr">return</span> <span class="n">self</span>
<span class="kr">end</span>

<span class="n">rect1</span> <span class="o">=</span> <span class="n">rect</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rect1 rectangle:&quot;</span><span class="p">,</span> <span class="n">rect1</span><span class="p">:</span><span class="n">getArea</span><span class="p">())</span>

<span class="n">cuboid1</span> <span class="o">=</span> <span class="n">cuboid</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid1 volume: &quot;</span><span class="p">,</span> <span class="n">cuboid1</span><span class="p">:</span><span class="n">getVolume</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid1 rectangle: &quot;</span><span class="p">,</span> <span class="n">cuboid1</span><span class="p">:</span><span class="n">getArea</span><span class="p">())</span>             <span class="c1">--子类调用父类方法getArea</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid1 length function: &quot;</span><span class="p">,</span> <span class="n">cuboid1</span><span class="p">:</span><span class="n">getLength</span><span class="p">())</span>     <span class="c1">--子类调用父类方法getLength</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid1 length variable: &quot;</span><span class="p">,</span> <span class="n">cuboid1</span><span class="p">.</span><span class="n">length</span><span class="p">)</span>          <span class="c1">--子类使用父类变量length</span>

<span class="c1">--重写子类接口getArea， lua中没有重载</span>
<span class="kr">function</span> <span class="nc">cuboid</span><span class="p">:</span><span class="nf">getArea</span><span class="p">()</span>                                   
    <span class="kr">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">length</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span><span class="p">)</span>
<span class="kr">end</span>

<span class="n">cuboid2</span> <span class="o">=</span> <span class="n">cuboid</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid2 function: getArea: &quot;</span><span class="p">,</span> <span class="n">cuboid2</span><span class="p">:</span><span class="n">getArea</span><span class="p">())</span>                     <span class="c1">--调用子类重写的方法getArea</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cuboid2 base function: getArea: &quot;</span><span class="p">,</span> <span class="nb">getmetatable</span><span class="p">(</span><span class="n">cuboid2</span><span class="p">):</span><span class="n">getArea</span><span class="p">())</span>  <span class="c1">--显示调用父类方法getArea</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	模块与C包: 模块类似封装库， 有利于代码复用， 降低耦合， 提供被调用的API。</span>
<span class="cm">	----------------------------------------------------------------------</span>
<span class="cm">	-- 文件名为 module.lua, 定义一个名为 module 的模块</span>
<span class="cm">	module = {}</span>
<span class="cm">	module.constant = &quot;这是一个常量&quot;</span>
<span class="cm">	function module.func1()</span>
<span class="cm">		io.write(&quot;这是一个公有函数！\n&quot;)</span>
<span class="cm">	end</span>
<span class="cm">	</span>
<span class="cm">	local function func2()</span>
<span class="cm">		print(&quot;这是一个私有函数！&quot;)</span>
<span class="cm">	end</span>
<span class="cm">	</span>
<span class="cm">	function module.func3()</span>
<span class="cm">		func2()</span>
<span class="cm">	end</span>
<span class="cm"> </span>
<span class="cm">	return module</span>
<span class="cm">	</span>
<span class="cm">	在其他模块中调用module模块：</span>
<span class="cm">	local m = require(&quot;module&quot;)</span>
<span class="cm">	print(m.constant)</span>
<span class="cm">	----------------------------------------------------------------------</span>
<span class="cm">	与Lua中写包不同，C包在使用以前必须首先加载并连接，在大多数系统中最容易的实现方式</span>
<span class="cm">	是通过动态连接库机制。Lua在一个叫loadlib的函数内提供了所有的动态连接的功能。</span>
<span class="cm">	</span>
<span class="cm">	----------------------------------------------------------------------</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	lua标准库： 标准库中接口可直接使用不需要require</span>
<span class="cm">	常用标准库：</span>
<span class="cm">		math		数学计算</span>
<span class="cm">		table		表结构数据处理</span>
<span class="cm">		string		字符串处理</span>
<span class="cm">		os			系统库函数</span>
<span class="cm">		io			文件读写</span>
<span class="cm">		coroutine	协程库</span>
<span class="cm">		debug		调式器</span>
<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>


<span class="c1">---------------------------------------------------------------------------------</span>
<span class="cm">--[[</span>
<span class="cm">	lua虚拟机：脚本语言没有像编译型语言那样直接编译为机器能识别的机器代码，这意味着</span>
<span class="cm">	解释性脚本语言与编译型语言的区别：由于每个脚本语言都有自己的一套字节码，与具体的</span>
<span class="cm">	硬件平台无关，所以无需修改脚本代码，就能运行在各个平台上。硬件、软件平台的差异都</span>
<span class="cm">	由语言自身的虚拟机解决。由于脚本语言的字节码需要由虚拟机执行，而不像机器代码那样</span>
<span class="cm">	能够直接执行，所以运行速度比编译型语言差不少。有了虚拟机这个中间层，同样的代码可</span>
<span class="cm">	以不经修改就运行在不同的操作系统、硬件平台上。Java、Python都是基于虚拟机的编程语</span>
<span class="cm">	言，Lua同样也是这样。</span>


<span class="cm">--]]</span>
<span class="c1">---------------------------------------------------------------------------------</span>




<span class="c1">--可在命令行lua lua.lua运行本脚本</span>
</pre></div>
</body>
</html>
